<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colors</title>
    <script>
        function write(selector, text) {
            const e = document.querySelector(selector);
            if (typeof text === "object") {
                for (const [k, v] of Object.entries(text)) {
                    e[k] = v;
                }
            } else {
                e.innerText = text;
            }
        }

        function pick(items) {
            return items[Math.floor(Math.random() * items.length)];
        }
    </script>
    <script type="module">
        import { colors, isColorful, coordinating, contrasting, neutrals, whites, darks, toColor } from "./colors.js";

        class ColorSwatch extends HTMLElement {

            connectedCallback() {
                const color = toColor(this.dataset.color); 
                this.dataset.colorJSON = JSON.stringify(color, null, 2);

                this.style.backgroundColor = color.color;

                let title = this.querySelector(".title") ?? undefined;
                if (title === undefined) {
                    title = this.ownerDocument.createElement("div");
                    title.classList.add("title");
                    this.append(title);
                }

                title.innerText = color.title.replaceAll(/[™®]/g, "");

                title.style.fill = color.color;
                title.style.backgroundColor = color.color;
                title.style.color = color.hsl.l > 70 ? "black" : "white";
            }
        }

        customElements.define("color-swatch", ColorSwatch);

        function pickColorful(colors) {
            while (true) {
                const result = pick(colors);
                if (isColorful(result)) {
                    return result;
                }
            }
        }
        const primary = pickColorful(colors);
        const fns = { coordinating, contrasting, neutrals, whites, darks };

        const all = { primary };
        for (const key of Object.keys(fns)) {
            all[key] = fns[key](primary);
        }

        console.log(all);
        console.log(colors);

        document.body.innerHTML = `<color-swatch data-color="${primary.id}"></color-swatch>`;
    </script>
    <style>
        color-swatch {
            display: block;
            width: 10vh;
            height: 10vh;
        }
    </style>
</head>
<body>
    
</body>
</html>